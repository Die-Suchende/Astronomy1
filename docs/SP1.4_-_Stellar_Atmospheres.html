<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr Rosaria Lena">
<meta name="dcterms.date" content="2026-01-11">
<meta name="description" content="Lectures 8-9 (part 1.4).">

<title>Stellar Physics - 4&nbsp; Stellar Atmospheres</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./SP1.5_-_Stellar_Models.html" rel="next">
<link href="./SP1.3_-_Variables_and_Binaries.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./SP1.4_-_Stellar_Atmospheres.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Stellar Atmospheres</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Stellar Atmospheres</span></h1>
                  <div>
        <div class="description">
          <em>Lectures 8-9</em> (part 1.4).
        </div>
      </div>
                </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">email</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Dr Rosaria Lena </p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              rosaria.lena@glasgow.ac.uk
            </p>
        </div>
      </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 11, 2026</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Stellar Physics</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Stellar-Physics.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Stellar-Physics.epub">
              <i class="bi bi-bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SP1.1_-_Stellar_Properties.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Stellar properties</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SP1.2_-_Stellar_classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Classifying stars</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SP1.3_-_Variables_and_Binaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Variables and binaries</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SP1.4_-_Stellar_Atmospheres.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Stellar Atmospheres</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SP1.5_-_Stellar_Models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Stellar Models and Evolution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SP1.6_-_Post-Main-Sequence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Post-main-sequence Evolution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SP2.1_-_Supernovae.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Supernovae</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SP2.2_-_Degenerate_Matter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Degenerate Matter and Degeneracy Pressure</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SP2.3_-_White_Dwarfs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">White Dwarfs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SP2.4_-_Neutron_Stars.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Neutron Stars</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SP2.5_-_Black_Holes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Black Holes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#vogt-russell-theorem" id="toc-vogt-russell-theorem" class="nav-link active" data-scroll-target="#vogt-russell-theorem"><span class="header-section-number">4.1</span> Vogt-Russell Theorem</a></li>
  <li><a href="#the-suns-atmosphere" id="toc-the-suns-atmosphere" class="nav-link" data-scroll-target="#the-suns-atmosphere"><span class="header-section-number">4.2</span> The Sun’s atmosphere</a>
  <ul class="collapse">
  <li><a href="#the-photosphere" id="toc-the-photosphere" class="nav-link" data-scroll-target="#the-photosphere"><span class="header-section-number">4.2.1</span> The Photosphere</a></li>
  <li><a href="#the-chromosphere" id="toc-the-chromosphere" class="nav-link" data-scroll-target="#the-chromosphere"><span class="header-section-number">4.2.2</span> The Chromosphere</a></li>
  <li><a href="#the-transition-region" id="toc-the-transition-region" class="nav-link" data-scroll-target="#the-transition-region"><span class="header-section-number">4.2.3</span> The Transition Region</a></li>
  <li><a href="#the-corona" id="toc-the-corona" class="nav-link" data-scroll-target="#the-corona"><span class="header-section-number">4.2.4</span> The Corona</a></li>
  <li><a href="#solar-activity" id="toc-solar-activity" class="nav-link" data-scroll-target="#solar-activity"><span class="header-section-number">4.2.5</span> Solar activity</a></li>
  <li><a href="#solar-observations" id="toc-solar-observations" class="nav-link" data-scroll-target="#solar-observations"><span class="header-section-number">4.2.6</span> Solar observations</a></li>
  </ul></li>
  <li><a href="#spectroscopy" id="toc-spectroscopy" class="nav-link" data-scroll-target="#spectroscopy"><span class="header-section-number">4.3</span> Spectroscopy</a>
  <ul class="collapse">
  <li><a href="#doppler-shifts" id="toc-doppler-shifts" class="nav-link" data-scroll-target="#doppler-shifts"><span class="header-section-number">4.3.1</span> Doppler shifts</a></li>
  <li><a href="#explanation-of-spectral-lines-the-bohr-model" id="toc-explanation-of-spectral-lines-the-bohr-model" class="nav-link" data-scroll-target="#explanation-of-spectral-lines-the-bohr-model"><span class="header-section-number">4.3.2</span> Explanation of spectral lines: the Bohr model</a></li>
  <li><a href="#question" id="toc-question" class="nav-link" data-scroll-target="#question"><span class="header-section-number">4.3.3</span> <span style="color:#336699;">Question</span></a></li>
  <li><a href="#series-of-lines-in-hydrogen" id="toc-series-of-lines-in-hydrogen" class="nav-link" data-scroll-target="#series-of-lines-in-hydrogen"><span class="header-section-number">4.3.4</span> Series of lines in Hydrogen</a></li>
  <li><a href="#spectral-lines-in-the-light-from-the-sun" id="toc-spectral-lines-in-the-light-from-the-sun" class="nav-link" data-scroll-target="#spectral-lines-in-the-light-from-the-sun"><span class="header-section-number">4.3.5</span> Spectral lines in the light from the Sun</a></li>
  <li><a href="#boltzmann-distribution" id="toc-boltzmann-distribution" class="nav-link" data-scroll-target="#boltzmann-distribution"><span class="header-section-number">4.3.6</span> Boltzmann distribution</a></li>
  <li><a href="#energy-level-occupation" id="toc-energy-level-occupation" class="nav-link" data-scroll-target="#energy-level-occupation"><span class="header-section-number">4.3.7</span> Energy level occupation</a></li>
  <li><a href="#energy-difference-for-hydrogen-lines" id="toc-energy-difference-for-hydrogen-lines" class="nav-link" data-scroll-target="#energy-difference-for-hydrogen-lines"><span class="header-section-number">4.3.8</span> Energy difference for Hydrogen lines</a></li>
  <li><a href="#rydberg-equation-for-other-elements" id="toc-rydberg-equation-for-other-elements" class="nav-link" data-scroll-target="#rydberg-equation-for-other-elements"><span class="header-section-number">4.3.9</span> Rydberg Equation for other elements</a></li>
  </ul></li>
  <li><a href="#ionisation" id="toc-ionisation" class="nav-link" data-scroll-target="#ionisation"><span class="header-section-number">4.4</span> Ionisation</a>
  <ul class="collapse">
  <li><a href="#ion-formation" id="toc-ion-formation" class="nav-link" data-scroll-target="#ion-formation"><span class="header-section-number">4.4.1</span> Ion formation</a></li>
  </ul></li>
  <li><a href="#spectra-and-chemical-composition" id="toc-spectra-and-chemical-composition" class="nav-link" data-scroll-target="#spectra-and-chemical-composition"><span class="header-section-number">4.5</span> Spectra and chemical composition</a>
  <ul class="collapse">
  <li><a href="#chemical-composition-of-the-solar-photosphere" id="toc-chemical-composition-of-the-solar-photosphere" class="nav-link" data-scroll-target="#chemical-composition-of-the-solar-photosphere"><span class="header-section-number">4.5.1</span> Chemical composition of the Solar Photosphere</a></li>
  <li><a href="#line-strength" id="toc-line-strength" class="nav-link" data-scroll-target="#line-strength"><span class="header-section-number">4.5.2</span> Line strength</a></li>
  <li><a href="#effects-of-temperature" id="toc-effects-of-temperature" class="nav-link" data-scroll-target="#effects-of-temperature"><span class="header-section-number">4.5.3</span> Effects of temperature</a></li>
  <li><a href="#population-i-stars" id="toc-population-i-stars" class="nav-link" data-scroll-target="#population-i-stars"><span class="header-section-number">4.5.4</span> Population I stars</a></li>
  <li><a href="#population-ii-stars" id="toc-population-ii-stars" class="nav-link" data-scroll-target="#population-ii-stars"><span class="header-section-number">4.5.5</span> Population II stars</a></li>
  <li><a href="#chemical-composition-of-the-universe" id="toc-chemical-composition-of-the-universe" class="nav-link" data-scroll-target="#chemical-composition-of-the-universe"><span class="header-section-number">4.5.6</span> Chemical Composition of the Universe</a></li>
  <li><a href="#molecular-bands" id="toc-molecular-bands" class="nav-link" data-scroll-target="#molecular-bands"><span class="header-section-number">4.5.7</span> Molecular Bands</a></li>
  </ul></li>
  <li><a href="#recap" id="toc-recap" class="nav-link" data-scroll-target="#recap"><span class="header-section-number">4.6</span> Recap</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<hr>
<p>So far we have thought of at stars as simplified balls of hot gas. In this part we will start to invetigate the composition and structure of stars. As we have seen, there are dark lines in the spectra of stars that can reveal their composition.</p>
<section id="vogt-russell-theorem" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="vogt-russell-theorem"><span class="header-section-number">4.1</span> Vogt-Russell Theorem</h2>
<p>In the structure and evolution of a star, the “Vogt-Russell theorem” plays an important role. It states that the structure of a star, in hydrostatic and thermal equilibrium, with all energy derived from nuclear reactions, is uniquely determined by its mass and the distribution of chemical elements throughout its interior.</p>
<p>In Chapter 2 we already gave an introduction to the spectral classification, based on the chemical elements present in the stars, and we anticipated that these can be determined through spectroscopy.</p>
<p><strong>Spectroscopy</strong> is the method for identifying the elements by their spectral lines.</p>
<p>Remember KircHhoff’s Laws from Chapter 2 (see <a href="SP1.2_-_Stellar_classification.html#fig-kirchhoffs-laws">Figure&nbsp;<span>2.12</span></a>):</p>
<ul>
<li><strong>1.</strong> A hot and opaque solid, liquid or highly compressed gas emits a continuous blackbody as-named by Kirchhoff spectrum with no spectral lines</li>
<li><strong>2.</strong> A hot, transparent gas, illuminated by a continuum source, produces a spectrum of bright emission lines</li>
<li><strong>3.</strong> If a continuous spectrum passes through a transparent gas at a lower temperature, the cooler gas will absorb at characteristic wavelengths resulting in dark absorption lines</li>
</ul>
<p>Kirchoff’s laws tell us that the absorption lines indicate the presence of a cooler layer of diffuse gas, on top of a hot layer of denser gas.</p>
<p>In order to understand the structure and the evolution of a star, it is therefore important to study its chemical composition both of the core and of its atmosphere. Let’s start by looking at the Sun.</p>
</section>
<section id="the-suns-atmosphere" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="the-suns-atmosphere"><span class="header-section-number">4.2</span> The Sun’s atmosphere</h2>
<div id="fig-sun-atmosphere-scheme" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/SunAtmosphereSchematic.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.1: Scheme of Sun’s atmosphere</figcaption>
</figure>
</div>
<p>When we observe the Sun, we see light from:</p>
<ul>
<li>The Photosphere</li>
<li>The Chromosphere</li>
<li>The Transition Region</li>
<li>The Corona</li>
</ul>
<p>in descending order of contribution.</p>
<section id="the-photosphere" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="the-photosphere"><span class="header-section-number">4.2.1</span> The Photosphere</h3>
<p>The Sun has no solid surface but becomes opaque to visible light at the photosphere.</p>
<p>The photosphere is about 500 km thick and temperature, T , varies throughout.</p>
<ul>
<li><span class="math inline">\(T_{base} \approx 6500 \mathrm{K}\)</span></li>
<li><span class="math inline">\(T_{top} \approx 4400 \mathrm{K}\)</span></li>
</ul>
<p>Most of the light comes from a region where the temperature <span class="math inline">\(T \approx 5800\)</span> K, where the density is about one thousandth that of air.</p>
<p><em>So the Sun is not a perfect black-body with a single temperature.</em></p>
<p>What do you notice from the videos below?</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/f9m6ouKpuH4" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/hXEYbovTUr0" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/8S-B066O88o" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<ul>
<li><p>The Photosphere is marked by:</p>
<ul>
<li>Bright, bubbling granules of plasma</li>
<li>Solar flares (electromagnetic eruptions)</li>
<li>Darker, cooler sunspots</li>
</ul></li>
<li><p>Sunspots are NOT really cool, just about 1500K cooler than the rest of the photosphere</p></li>
<li><p>Sunspots appear to move across the Sun’s disk, showing us that the Sun is actually rotating</p></li>
<li><p>The Sun is a ball of gas, not a solid, and different regions rotate at different rates</p></li>
<li><p>The Sun’s equatorial regions rotate in about 24 days</p></li>
<li><p>The polar regions take more than 30 days</p></li>
<li><p>Solar flares - extending hundreds of thousands of miles above the surface - originate in the photosphere</p></li>
<li><p>These flares produce bursts of radiation across the electromagnetic spectrum, from X-rays, to radio waves (see <a href="#fig-solar-flares">Figure&nbsp;<span>4.2</span></a>).</p></li>
</ul>
<div id="fig-solar-flares" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/solar_flares.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.2: Solar flares observed at different wavelengths as per label in each section (in Angstrom).</figcaption>
</figure>
</div>
</section>
<section id="the-chromosphere" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="the-chromosphere"><span class="header-section-number">4.2.2</span> The Chromosphere</h3>
<div id="fig-chromosphere" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/chromosphere.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.3: The chromosphere. Image credit: <a href="http://antwrp.gsfc.nasa.gov/apod/ap040611.html">NASA</a>.</figcaption>
</figure>
</div>
<ul>
<li>We get only a little light from the chromosphere – the next layer of gas</li>
<li>The chromosphere is seen as a dim reddish-pink glow from super-heated Hydrogen</li>
<li>The glow is only really seen during an eclipse</li>
<li>At other times, light from the chromosphere is usually too weak to be seen against the brighter photosphere</li>
<li>The chromosphere is about 2000 km thick</li>
<li>It is hottest furthest from the Sun: <span class="math inline">\(T \approx 20000\)</span> K</li>
</ul>
</section>
<section id="the-transition-region" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="the-transition-region"><span class="header-section-number">4.2.3</span> The Transition Region</h3>
<ul>
<li>The transition region is a layer of ~300 km between the chromosphere and the corona.</li>
<li>The temperature in the transition region increases very rapidly within 100 km towards the corona, reaching over <span class="math inline">\(10^5\)</span> K.</li>
<li>The increase of temperature then becomes less sharp, reaching <span class="math inline">\(~10^6\)</span> K at the top of the transition region.</li>
</ul>
</section>
<section id="the-corona" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="the-corona"><span class="header-section-number">4.2.4</span> The Corona</h3>
<div id="fig-corona" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/corona.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.4: Image of the corona seen during a solar eclipse.</figcaption>
</figure>
</div>
<ul>
<li>Very hot : <span class="math inline">\(T\approx 10^6\)</span> K</li>
<li>Outer atmosphere, extending as far as <span class="math inline">\(\approx 3 R_\odot\)</span></li>
<li>Again, only really seen visually from Earth during an eclipse</li>
<li>Together with the chromosphere, it contributes about <span class="math inline">\(10^{-4} L_\odot\)</span></li>
<li>Very diffuse and eventually leads to the Solar Wind
<ul>
<li>the solar wind stretches out to about 100 AU</li>
<li>its effect is seen on Earth as the Aurora</li>
</ul></li>
</ul>
</section>
<section id="solar-activity" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="solar-activity"><span class="header-section-number">4.2.5</span> Solar activity</h3>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/80SnZM8tcD8" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Solar flares can produce aurora (<a href="#fig-solar-wind-aurora">Figure&nbsp;<span>4.5</span></a>, <a href="#fig-aurora">Figure&nbsp;<span>4.6</span></a>).</p>
<div id="fig-solar-wind-aurora" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/solar-wind-aurora.jpeg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.5: A scheme of the effects of solar flares and solar wind on the geomagnetic shield, causing the aurora borealis.</figcaption>
</figure>
</div>
<div id="fig-aurora" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/aurora.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.6: The aurora borealis over Alaska.</figcaption>
</figure>
</div>
</section>
<section id="solar-observations" class="level3" data-number="4.2.6">
<h3 data-number="4.2.6" class="anchored" data-anchor-id="solar-observations"><span class="header-section-number">4.2.6</span> Solar observations</h3>
<p>Observations of the Sun at different wavelengths can reveal different structures in the solar atmosphere (<a href="#fig-sun-ultraviolet">Figure&nbsp;<span>4.7</span></a>, <a href="#fig-sun-multiband">Figure&nbsp;<span>4.8</span></a>).</p>
<div id="fig-sun-ultraviolet" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/Sun_1MK.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.7: Sun in extreme ultraviolet light. This image from SOHO highlights temperatures of ~1 MK.</figcaption>
</figure>
</div>
<div id="fig-sun-multiband" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/sun_multiband.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.8: Sun in different wavebands.</figcaption>
</figure>
</div>
</section>
</section>
<section id="spectroscopy" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="spectroscopy"><span class="header-section-number">4.3</span> Spectroscopy</h2>
<p>We talked in Chapter 2 about absorption and emission spectra, and how these can be used in spectroscopy to learn about the composition of stars.</p>
<p>Let’s look at a star spectrum, such as <a href="SP1.2_-_Stellar_classification.html#fig-sdss-spectrum-g2">Figure&nbsp;<span>2.20</span></a>.</p>
<ul>
<li>Each chemical element has its unique spectral line fingerprint</li>
<li>From a measurement of its spectrum, the pattern of lines seen allows identification of the elements in a star’s atmosphere</li>
<li>Strengths of the spectral lines tells us about stellar temperature; line strength depends on
<ul>
<li>number of atoms present</li>
<li>temperature of the gas</li>
</ul></li>
</ul>
<section id="doppler-shifts" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="doppler-shifts"><span class="header-section-number">4.3.1</span> Doppler shifts</h3>
<p>In Chapter 3 we saw that in spectroscopic binaries we can measure the speed of stars by measuring the doppler shift of the spectral line. These are the result of the motion of the stars towards and away from us (see <a href="SP1.3_-_Variables_and_Binaries.html#fig-spectroscopic-binary">Figure&nbsp;<span>3.15</span></a>).</p>
<p>We saw however that stars (e.g.&nbsp;the Sun) are not rigid bodies, so the activity of the atmosphere can also cause doppler shifts.</p>
<ul>
<li>Wavelengths and ‘widths’ of lines are affected by Doppler shifts due to the motion of the stellar atmosphere
<ul>
<li>Effects on lines due to bulk motions allow measurement of overall rotation and large-scale expansion or contraction (e.g.: Cepheids)</li>
<li>Effects on lines due to random thermal motions of atoms in the atmosphere allow measurement of temperature and pressure</li>
</ul></li>
<li>But it can be hard to disentangle all of these!</li>
</ul>
</section>
<section id="explanation-of-spectral-lines-the-bohr-model" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="explanation-of-spectral-lines-the-bohr-model"><span class="header-section-number">4.3.2</span> Explanation of spectral lines: the Bohr model</h3>
<p>We really need Quantum Mechanics to accurately understand spectral lines. However, we can simplify the explanation using the Bohr Model of the atom. This works well for Hydrogen, and sometimes for other elements too. Since most of the Sun is made of Hydrogen, we will stick to this simple picture for the moment.</p>
<p>In the Bohr model:</p>
<ul>
<li>Electrons, bound in atoms, are only allowed certain energies</li>
<li>These energies correspond to certain ‘orbits’ around the nucleus (<a href="#fig-bohr-model">Figure&nbsp;<span>4.9</span></a>)</li>
<li>These orbits must have angular momenta equal to an integer multiple of a universal constant – Planck’s constant</li>
<li>Only photons with energies corresponding to differences between energy levels can be emitted or absorbed</li>
</ul>
<div id="fig-bohr-model" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/bohr-model.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.9: Representation of the Bohr model with the first three orbits of the hydrogen atom.</figcaption>
</figure>
</div>
<p>The energy of the n-th level of hydrogen is given by the relationship <span id="eq-h-energy-levels"><span class="math display">\[
E_n = -\frac{13.6}{n^2}\,\mathrm{eV},
\tag{4.1}\]</span></span> and they are represented in <a href="#fig-h-energy-levels">Figure&nbsp;<span>4.10</span></a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>eV is an electron-volt, a small unit of energy (not voltage!) - <span class="math inline">\(1\, \mathrm{eV} = 1.602\times 10^{-19}\, \mathrm{J}\)</span></p>
</div>
</div>
<div id="fig-h-energy-levels" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/hydrogen-energy-levels.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.10: Energy levels of the Hydrogen atom.</figcaption>
</figure>
</div>
<p>The energies are negative because they refer to ‘bound states’, where the electrons are in their orbits around the nucleus.</p>
<p>For a transition between <em>level <span class="math inline">\(m\)</span> (final state)</em> and <em>level <span class="math inline">\(n\)</span> (initial state)</em>, the photon emitted or absorbed would have energy corresponding to the energy difference between the states <span id="eq-h-energy-transitions"><span class="math display">\[
\Delta E_{mn} = E_m - E_n = 13.6\, \mathrm{eV}\left(\frac{1}{n^2} - \frac{1}{m^2}\right).
\tag{4.2}\]</span></span></p>
<p>From quantum theory we can relate the energy to the wavelength: <span class="math inline">\(\Delta E_{mn} = \frac{hc}{\lambda_{mn}}\)</span>.</p>
<p>So this means we can calculate the wavelength of the emitted photon: <span id="eq-rydberg-eq"><span class="math display">\[
\frac{1}{\lambda_{mn}} = R_\infty \left(\frac{1}{n^2} - \frac{1}{m^2}\right).
\tag{4.3}\]</span></span></p>
<p>All the constants are hidden in <span class="math inline">\(R_\infty\)</span>. This equation is the <strong>Rydberg Equation</strong>.</p>
<p><span class="math inline">\(R_\infty = 1.097\times 10^{7}\,m^{-1}\)</span> is the <strong>Rydberg constant</strong>.</p>
<p>This formula is valid for both emission and absorption transitions.</p>
<p>Depending on the values of <span class="math inline">\(m\)</span> and <span class="math inline">\(n\)</span>, we can calculate the characteristic wavelengths (of the lines) corresponding to several series of transitions.</p>
<p><strong>Emission</strong></p>
<ul>
<li>Electron drops to a lower level</li>
<li>Photon is emitted, of energy corresponding to the energy difference between the transition levels</li>
</ul>
<p><strong>Absorption</strong></p>
<ul>
<li>Electron jumps to a higher level</li>
<li>Photon of the correct energy – corresponding to the energy level difference – is needed for this to happen</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>When doing calculations remember that the result for wavelength must be</p>
<ul>
<li>positive for absorption transitions (<span class="math inline">\(n &lt; m\)</span>)</li>
<li>negative for emission transitions (<span class="math inline">\(n &gt; m\)</span>).</li>
</ul>
</div>
</div>
</section>
<section id="question" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="question"><span class="header-section-number">4.3.3</span> <span style="color:#336699;">Question</span></h3>
<p>Calculate the energy of a photon:</p>
<ol type="1">
<li>emitted by a hydrogen atom going from the state <span class="math inline">\(n=3\)</span> to <span class="math inline">\(m=2\)</span></li>
<li>absorbed by a hydrogen atom undergoing the transition from <span class="math inline">\(n=1\)</span> to <span class="math inline">\(m=2\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Do you expect a positive or negative sign for each case?</p>
</div>
</div>
</div>
<details>
<summary>
Solution
</summary>
<p>Using <a href="#eq-h-energy-transitions">Equation&nbsp;<span>4.2</span></a>:</p>
<ol type="1">
<li><p><span class="math display">\[
\begin{aligned}
\Delta E_{23}&amp;=E_2-E_3=13.6\,\mathrm{eV}\left(\frac{1}{3^2}-\frac{1}{2^2}\right)\\
&amp;=-1.89\,\mathrm{eV}.
\end{aligned}
\]</span></p></li>
<li><p><span class="math display">\[
\begin{aligned}
\Delta E_{21}&amp;=E_2-E_1=13.6\,\mathrm{eV}\left(\frac{1}{1^2}-\frac{1}{2^2}\right)\\
&amp;=10.2\,\mathrm{eV}.
\end{aligned}
\]</span></p></li>
</ol>
</details>
</section>
<section id="series-of-lines-in-hydrogen" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="series-of-lines-in-hydrogen"><span class="header-section-number">4.3.4</span> Series of lines in Hydrogen</h3>
<p>In Hydrogen some of the transitions have special names. The spectral lines originating from the transitions going from higher energy levels to <span class="math inline">\(n=1, n=2, n=3\)</span> are called respectively <em>Lyman series</em>, <em>Balmer series</em> and <em>Paschen series</em>. These are represented in <a href="#fig-h-transitions">Figure&nbsp;<span>4.11</span></a>.</p>
<div id="fig-h-transitions" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/hydrogen-transitions.jpeg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.11: Emission transitions for the Hydrogen atom resulting in the Lyman, Balmer and Paschen series.</figcaption>
</figure>
</div>
<p><strong>Lyman Series</strong> (Ly): Transitions between excited states <span class="math inline">\(m&gt;1\)</span> and the ground state (<span class="math inline">\(n=1\)</span>), in the ultraviolet.</p>
<ul>
<li>Ly<span class="math inline">\(\alpha\)</span>: m=2 to n=1</li>
<li>Ly<span class="math inline">\(\beta\)</span>: m=3 to n=1</li>
<li>etc</li>
</ul>
<p><strong>Balmer Series</strong> (H): Transitions between <span class="math inline">\(m&gt;2\)</span> and <span class="math inline">\(n=2\)</span>, in the visible.</p>
<ul>
<li>H<span class="math inline">\(\alpha\)</span>: m=3 to n=2</li>
<li>H<span class="math inline">\(\beta\)</span>: m=4 to n=2</li>
<li>etc</li>
</ul>
<p><strong>Paschen Series</strong> (P): Transitions between <span class="math inline">\(m&gt;3\)</span> and <span class="math inline">\(n=3\)</span>, in the infrared.</p>
<ul>
<li>P<span class="math inline">\(\alpha\)</span>: m=4 to n=3</li>
<li>P<span class="math inline">\(\beta\)</span>: m=5 to n=3</li>
<li>etc</li>
</ul>
<p>The ones listed here are emission transitions, but the same is valid for absorption transitions, swapping initial and final states.</p>
</section>
<section id="spectral-lines-in-the-light-from-the-sun" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="spectral-lines-in-the-light-from-the-sun"><span class="header-section-number">4.3.5</span> Spectral lines in the light from the Sun</h3>
<p>The strongest visible absorption line from solar hydrogen is H<span class="math inline">\(\alpha\)</span> at <span class="math inline">\(656.3\)</span> nm (labelled <span class="math inline">\(C\)</span> in <a href="#fig-wavelengths-solar-spectrum">Figure&nbsp;<span>4.12</span></a>).</p>
<div id="fig-wavelengths-solar-spectrum" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/wavelengths-spectrum-lines-sun.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.12: Absorption lines and corresponding wavelengths in the solar spectrum.</figcaption>
</figure>
</div>
<ul>
<li>We see this in absorption in the chromosphere</li>
<li>We see other atoms in absorption: hydrogen, helium, magnesium, sodium, iron, chromium …</li>
<li>There are about 250,000 lines in total (see <a href="SP1.2_-_Stellar_classification.html#fig-solar-spectrum">Figure&nbsp;<span>2.10</span></a>)</li>
<li>Identify by heating elements in the lab and observing spectra</li>
</ul>
</section>
<section id="boltzmann-distribution" class="level3" data-number="4.3.6">
<h3 data-number="4.3.6" class="anchored" data-anchor-id="boltzmann-distribution"><span class="header-section-number">4.3.6</span> Boltzmann distribution</h3>
<p><strong>Will H<span class="math inline">\(\alpha\)</span> absorption happen?</strong></p>
<p>H<span class="math inline">\(\alpha\)</span> absorption involves an electron going from from <span class="math inline">\(m = 2\)</span> to <span class="math inline">\(n = 3\)</span> - i.e.&nbsp;the electron must already be in an excited state!</p>
<p>The electron gets from the ground state (<span class="math inline">\(n=1\)</span>) to the <span class="math inline">\(n = 2\)</span> state by thermal excitation. The probability of an electron occupying energy state <span class="math inline">\(E\)</span> is given by the <em>Boltzmann distribution</em>: <span id="eq-boltzmann-distr"><span class="math display">\[
P(E) \propto \exp\left(-\frac{E}{k_B T}\right)
\tag{4.4}\]</span></span></p>
<p>here <span class="math inline">\(k_B = 1.381\times 10^{-23}\, \mathrm{JK}^{-1}\)</span> is Boltzmann’s constant.</p>
<p>The minus sign in the exponential tells us that states with <span class="math inline">\(E\gg k_BT\)</span> are very improbable.</p>
</section>
<section id="energy-level-occupation" class="level3" data-number="4.3.7">
<h3 data-number="4.3.7" class="anchored" data-anchor-id="energy-level-occupation"><span class="header-section-number">4.3.7</span> Energy level occupation</h3>
<p>The <span class="math inline">\(n\)</span>-th energy shell in the atom can hold up to <span class="math inline">\(2(n^2)\)</span> electrons.</p>
<p>This means that</p>
<ul>
<li>2 electrons can occupy the <span class="math inline">\(n = 1\)</span> shell</li>
<li>8 electrons can occupy the <span class="math inline">\(n = 2\)</span> shell</li>
</ul>
<p>If there are 8 possible states in the n=2 shell, there is 8 times the probability of finding an electron there.</p>
<p>So we can calculate the ratio of the population of atoms in the two states from:</p>
<p><span id="eq-ratio-states-21"><span class="math display">\[
\frac{N_2}{N_1}=\frac{8\exp(-E_2/k_BT)}{2\exp(-E_1/k_BT)}= \frac{8}{2}\exp -\frac{\Delta E_{21}}{k_BT}
\tag{4.5}\]</span></span></p>
<p>Here <span class="math inline">\(\Delta E_{21}\)</span> is the energy difference between the n = 1 and n = 2 states.</p>
</section>
<section id="energy-difference-for-hydrogen-lines" class="level3" data-number="4.3.8">
<h3 data-number="4.3.8" class="anchored" data-anchor-id="energy-difference-for-hydrogen-lines"><span class="header-section-number">4.3.8</span> Energy difference for Hydrogen lines</h3>
<p>For Ly<span class="math inline">\(\alpha\)</span> we have</p>
<p><span class="math display">\[
\Delta E_{21} = h\nu_{21} = hc/\lambda_{21}
\]</span>{#eq-deltaE21-h1},</p>
<p><span id="eq-deltaE21-h2"><span class="math display">\[
\Delta E_{21} = hcR_\infty\left(\frac{1}{1^2}-\frac{1}{2^2}\right)= 1.64\times 10^{-18}\,\mathrm{J}.
\tag{4.6}\]</span></span></p>
<p><strong>What fraction of atoms are in the <span class="math inline">\(n=2\)</span> state?</strong></p>
<p>For <span class="math inline">\(T=6000\)</span>K, we find: <span id="eq-n2-fraction-h"><span class="math display">\[
\frac{N_2}{N_1} \approx 10^{-8}, \tag{4.7}\]</span></span></p>
<p>i.e.&nbsp;99,999,999 out of every 100 million hydrogen atoms is in the ground state.</p>
<p>So this transition is very unlikely at this temperature.</p>
<p>We still see this line though because there is just so much hydrogen in the Sun.</p>
</section>
<section id="rydberg-equation-for-other-elements" class="level3" data-number="4.3.9">
<h3 data-number="4.3.9" class="anchored" data-anchor-id="rydberg-equation-for-other-elements"><span class="header-section-number">4.3.9</span> Rydberg Equation for other elements</h3>
<ul>
<li>The Rydberg equation is a good approximation for Hydrogen.</li>
<li>Fails to take account of eletron orbital screening in heavier elements</li>
<li>But for single-electrons around heavier nuclei (i.e nearly fully ionised atoms) we can write</li>
</ul>
<p><span id="eq-rydberg-eq-general"><span class="math display">\[
\frac{1}{\lambda_{nm}} = Z^2 R_\infty\left(\frac{1}{m^2} - \frac{1}{n^2}\right),
\tag{4.8}\]</span></span></p>
<p>where <span class="math inline">\(Z\)</span> is the atomic number of the element.</p>
</section>
</section>
<section id="ionisation" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="ionisation"><span class="header-section-number">4.4</span> Ionisation</h2>
<ul>
<li>Under extreme conditions atoms can be ionised</li>
<li>If an atom is ionised it loses (one or more) electrons: these are no longer bound to the nucleus, they are free</li>
<li>Atoms can lose electrons if they absorb enough energy from photons</li>
<li>For hydrogen, this requires a minimum ionisation energy, <span class="math inline">\(\chi\)</span></li>
<li>We can find <span class="math inline">\(\chi\)</span> by using the Rydberg Equation (<a href="#eq-rydberg-eq">Equation&nbsp;<span>4.3</span></a>) with <span class="math inline">\(m=\infty\)</span>, corresponding to the energy <span class="math inline">\(E_\infty = 0\)</span> where the electron is free (see <a href="#fig-h-energy-levels">Figure&nbsp;<span>4.10</span></a>).</li>
</ul>
<p><span id="eq-ionisation-energy"><span class="math display">\[
\begin{aligned}
\chi &amp;= hc R_\infty\left(\frac{1}{n^2} - \frac{1}{\infty^2}\right)\\
&amp;= E_{\infty}-E_1=\frac{13.6}{n^2}\mathrm{eV}.
\end{aligned}
\tag{4.9}\]</span></span></p>
<p>This is the energy required to remove an electron from an energy level <span class="math inline">\(n\)</span> to the level <span class="math inline">\(m=\infty\)</span> (where it is no longer bound to the nucleus).</p>
<p>When the electron has been knocked out of the atom, an ion is left.</p>
<section id="ion-formation" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="ion-formation"><span class="header-section-number">4.4.1</span> Ion formation</h3>
<p>Ions formation occurs when some form of external energy ‘impacts’ the electrons in the atom. Due to conservation of energy, if this external energy is larger than the ionisation energy, electrons will be ejected.</p>
<div id="fig-ionisation-diagram" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/ionisation-diagram.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.13: Ionisation diagram.</figcaption>
</figure>
</div>
<p>This can occur due to two possible processes that introduce external energy:</p>
<ul>
<li><strong>Absoption</strong> of a photon with energy <span class="math inline">\(E\geq \chi\)</span></li>
<li><strong>Scattering</strong>: collision with another particle like an electron (this is also known as <em>impact ionisation</em> or <em>collision ionisation</em>).</li>
</ul>
<section id="ion-formation-by-photon-absorption" class="level4" data-number="4.4.1.1">
<h4 data-number="4.4.1.1" class="anchored" data-anchor-id="ion-formation-by-photon-absorption"><span class="header-section-number">4.4.1.1</span> Ion formation by photon absorption</h4>
<ul>
<li>In a black-body with temperature <span class="math inline">\(T\)</span>, photons have a distribution of energies</li>
<li>The average photon has energy <span class="math inline">\(E=k_B T\)</span>, but some have higher energy</li>
<li>Only photons with energies greater than the ionisation energy, <span class="math inline">\(\chi\)</span> , can cause ionisation to happen</li>
</ul>
<p>There will always be <em>some</em> sufficiently energetic photons.</p>
<div id="fig-ionisation-distribution" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/ionisation.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.14: Example of distribution of energies of photons in a black body at temperature <span class="math inline">\(T\)</span>, centered around the average energy. The ionisation energy here sits at the tail of the distribution.</figcaption>
</figure>
</div>
</section>
<section id="ion-formation-by-scattering" class="level4" data-number="4.4.1.2">
<h4 data-number="4.4.1.2" class="anchored" data-anchor-id="ion-formation-by-scattering"><span class="header-section-number">4.4.1.2</span> Ion formation by scattering</h4>
<p>Atoms in hot and dense gases can be ionised due to thermal collisions. Collisions can occur with other particles, e.g.: electrons. These are determined by the average kinetic thermal energy of the gas <span id="eq-thermal-kinetic"><span class="math display">\[
E=\frac{3}{2}k_B T.
\tag{4.10}\]</span></span></p>
<p>The principle governing impact ionisation is the <em>conservation of energy</em>. The energy keeping the electron bound to the nucleus (and therefore the ionisation energy) is a form of potential energy. If the kinetic energy of a particle hitting the electron is <span class="math inline">\(E&gt;\chi\)</span>, then the conservation of energy will ensure that the electron is ejected from the atom.</p>
<!-- so the fraction with $E>\chi$  will be higher. -->
<p><strong>What proportion of atoms do we expect to be ionised?</strong></p>
<p>We need to find the equilibrium in the following reaction:</p>
<p>external energy source + atom <span class="math inline">\(\leftrightharpoons\)</span> electron + ion,</p>
<p>where the external energy source can be a colliding particle or a photon.</p>
<p>The answer to this is given by the <em>Saha Equation</em>:</p>
<p><span id="eq-saha"><span class="math display">\[
\frac{\mathrm{number\ of\ atoms}}{\mathrm{number\ of\ ions}} \approx \frac{10^{21} T^{3/2} \exp(-\chi / k_B T)}{\mathrm{number\ of\ electrons}}.
\tag{4.11}\]</span></span></p>
<p>The rule of thumb is that 50% ionisation occurs when <span class="math inline">\(k_B T \approx \chi /18\)</span>.</p>
</section>
</section>
</section>
<section id="spectra-and-chemical-composition" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="spectra-and-chemical-composition"><span class="header-section-number">4.5</span> Spectra and chemical composition</h2>
<section id="chemical-composition-of-the-solar-photosphere" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="chemical-composition-of-the-solar-photosphere"><span class="header-section-number">4.5.1</span> Chemical composition of the Solar Photosphere</h3>
<ul>
<li>Temperature <span class="math inline">\(T\approx 6000\)</span>K</li>
<li><span class="math inline">\(18 k_BT \approx 9.3\,\mathrm{eV}\)</span></li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th>Element</th>
<th>Ionisation Energy (eV)</th>
<th>Status in photosphere</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>H</td>
<td>13.6</td>
<td>a few ions</td>
</tr>
<tr class="even">
<td>He</td>
<td>24.6</td>
<td>effectively no ions</td>
</tr>
<tr class="odd">
<td>Na</td>
<td>5.14</td>
<td>almost fully ionised</td>
</tr>
<tr class="even">
<td>Fe</td>
<td>7.9</td>
<td>almost fully ionised</td>
</tr>
</tbody>
</table>
</section>
<section id="line-strength" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="line-strength"><span class="header-section-number">4.5.2</span> Line strength</h3>
<p>Line strength depends on two things:</p>
<ul>
<li>Element abundance</li>
<li>Temperature</li>
</ul>
<p>Temperature is critical because it determines</p>
<ul>
<li>the number of atoms in the correct state</li>
<li>the number of photons with enough energy to cause transition.</li>
</ul>
<p>Line strength is, therefore, a good indicator of temperature.</p>
</section>
<section id="effects-of-temperature" class="level3" data-number="4.5.3">
<h3 data-number="4.5.3" class="anchored" data-anchor-id="effects-of-temperature"><span class="header-section-number">4.5.3</span> Effects of temperature</h3>
<ul>
<li>If a gas gets too hot, all the atoms may already be ionised
<ul>
<li>There may not be any low-level electrons able to absorb energy</li>
<li>There may not be any high-level electrons able to emit energy</li>
</ul></li>
<li>If a gas is too cool, electrons may be in too low an energy state for a particular line
<ul>
<li>Remember that Balmer absorption needs n = 2</li>
</ul></li>
</ul>
<p>Line strengths of different elements vary with temperature in different ways. This is crucial to the Harvard Classification scheme we looked at before (for the following it will help to refer to <a href="SP1.2_-_Stellar_classification.html#fig-harvard-classification-lines">Figure&nbsp;<span>2.19</span></a>).</p>
<section id="effects-of-temperature-on-hydrogen-lines" class="level4" data-number="4.5.3.1">
<h4 data-number="4.5.3.1" class="anchored" data-anchor-id="effects-of-temperature-on-hydrogen-lines"><span class="header-section-number">4.5.3.1</span> Effects of temperature on Hydrogen lines</h4>
<p>In what follows we will consider only spectral lines in the visible part of the spectra (Balmer series for hydrogen).</p>
<p>Balmer series is strongest when <span class="math inline">\(T\approx 10^4 K\)</span>.</p>
<ul>
<li>If it’s cooler, there are not enough photons to excite electrons</li>
<li>If it’s hotter, the atmosphere is fully ionised</li>
</ul>
<div id="fig-balmer-lines-h" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/BalmerLines.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.15: Balmer lines of Hydrogen at different temperatures</figcaption>
</figure>
</div>
</section>
<section id="effects-of-temperature-on-helium-lines" class="level4" data-number="4.5.3.2">
<h4 data-number="4.5.3.2" class="anchored" data-anchor-id="effects-of-temperature-on-helium-lines"><span class="header-section-number">4.5.3.2</span> Effects of temperature on Helium lines</h4>
<p>For visible lines, require <span class="math inline">\(T &gt; 10^4\)</span> K</p>
<p>Best temperature is <span class="math inline">\(T\approx 25000\)</span> K.</p>
<ul>
<li>Little is seen from the Sun in absorption although they are observed faintly in the upper chromosphere during eclipses</li>
<li>Helium ions can also be excited to a state that gives visual absorption lines if the temperature is ~350000 K, as in the corona.</li>
</ul>
</section>
<section id="metal-lines" class="level4" data-number="4.5.3.3">
<h4 data-number="4.5.3.3" class="anchored" data-anchor-id="metal-lines"><span class="header-section-number">4.5.3.3</span> Metal lines</h4>
<ul>
<li>In astronomy, ‘Metal’ means all elements after helium in the periodic table!</li>
<li>These are very rare (~ 0.1% of the stellar atmosphere)</li>
<li>Metal lines only dominate at low temperatures where hydrogen and helium are ‘frozen out’</li>
<li>Strong lines from singly ionised calcium and iron are observed, as are those from singly and doubly ionised iron if it’s hot enough</li>
</ul>
<p>The relative abundances of metals in all stars is fairly similar.</p>
<p>However the abundance of metals relative to hydrogen is very different in some stars!</p>
</section>
</section>
<section id="population-i-stars" class="level3" data-number="4.5.4">
<h3 data-number="4.5.4" class="anchored" data-anchor-id="population-i-stars"><span class="header-section-number">4.5.4</span> Population I stars</h3>
<p>The ratio of metals to hydrogen and helium is very much like that found in the Sun.</p>
<ul>
<li>Young stars, generally made from material ejected from older stars</li>
<li>They’ve formed late in the evolution of the Galaxy and, for that reason are found predominantly in the Galactic disk</li>
</ul>
</section>
<section id="population-ii-stars" class="level3" data-number="4.5.5">
<h3 data-number="4.5.5" class="anchored" data-anchor-id="population-ii-stars"><span class="header-section-number">4.5.5</span> Population II stars</h3>
<p>The ratio of metals to hydrogen and helium is 100 times less than that found in the Sun</p>
<ul>
<li>These are ‘metal poor’ stars</li>
<li>They are old stars, formed before the Galaxy was a disk and, therefore, are found predominantly in the Galactic halo</li>
</ul>
<div id="fig-galaxy-milky-way" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/galactic-disk-halo.jpeg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.16: Milky Way galaxy structure: the Sun is in the Galactic disk.</figcaption>
</figure>
</div>
</section>
<section id="chemical-composition-of-the-universe" class="level3" data-number="4.5.6">
<h3 data-number="4.5.6" class="anchored" data-anchor-id="chemical-composition-of-the-universe"><span class="header-section-number">4.5.6</span> Chemical Composition of the Universe</h3>
<table class="table">
<thead>
<tr class="header">
<th>Element</th>
<th>% of total atoms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>H</td>
<td>~85%</td>
</tr>
<tr class="even">
<td>He</td>
<td>~15%</td>
</tr>
<tr class="odd">
<td>C, N, O, Ne</td>
<td>~0.1% Each</td>
</tr>
<tr class="even">
<td>Si, Mg, Fe, Al</td>
<td>~0.01% Each</td>
</tr>
</tbody>
</table>
<p><em>What is the origin of the elements?</em></p>
</section>
<section id="molecular-bands" class="level3" data-number="4.5.7">
<h3 data-number="4.5.7" class="anchored" data-anchor-id="molecular-bands"><span class="header-section-number">4.5.7</span> Molecular Bands</h3>
<p>In <a href="SP1.2_-_Stellar_classification.html#fig-stellar-lines1">Figure&nbsp;<span>2.17</span></a> we saw that M-type stars have absorption molecular bands.</p>
<p>Molecules can form in the outer atmospheres of cool stars.</p>
<p>The typical binding energies of molecules are 4 - 6 eV.</p>
<ul>
<li><p>This means that the lines will ‘fade out’ if T &gt; ~5000 K</p></li>
<li><p>We observe TiO, ZrO, CN and sometimes even H<span class="math inline">\(_2\)</span>O.</p></li>
</ul>
</section>
</section>
<section id="recap" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="recap"><span class="header-section-number">4.6</span> Recap</h2>
<ul>
<li>The stellar structure, radius and luminosity of a star in thermal and gravitational equilibrium depends upon its chemical composition and mass (Vogt-Russell theorem).</li>
<li>The Sun’s atmosphere is composed by the photosphere, the chromosphere, the transition region and the corona. The photosphere is the one contributing the most to the intensity.</li>
<li>Spectral lines and their strengths are due to abundance of chemical elements in a star and its temperature.</li>
<li>Using the Bohr model we can obtain the Rydberg equation to explain transitions that generate spectral lines in hydrogen and almost fully ionised atoms.</li>
<li>Ionisation occurs when an atom loses electrons either due to absorption of photons or collisions with other particles.</li>
<li>The temperature of a star affects the proportion of atoms ionised (Saha equation) and the strength of the spectral lines of the various chemical elements.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./SP1.3_-_Variables_and_Binaries.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Variables and binaries</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./SP1.5_-_Stellar_Models.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Stellar Models and Evolution</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>